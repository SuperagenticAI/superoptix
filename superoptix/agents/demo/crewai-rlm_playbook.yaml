apiVersion: agent/v1
kind: AgentSpec
metadata:
  name: CrewAI RLM Demo
  id: crewai-rlm
  namespace: demo
  version: 1.0.0
  level: oracles
  description: CrewAI demo with optional RLM assist/replace execution.
  author: SuperOptiX
  tags:
    - crewai
    - rlm
    - reasoning
    - demo

spec:
  target_framework: crewai

  language_model:
    provider: google-genai
    model: google-genai:gemini-2.5-flash
    temperature: 0.1
    max_tokens: 2200

  persona:
    name: crew_reasoning_assistant
    role: Senior Systems Analyst
    goal: Produce concise, structured, and accurate reasoning outputs.
    backstory: >
      You are an engineering-focused assistant for complex planning and analysis.
      You expose assumptions, risks, and concrete next steps.
    traits:
      - analytical
      - concise
      - reliable
    instructions: |
      Keep answers structured and implementation-oriented.
      If assumptions are required, state them explicitly.

  input_fields:
    - name: query
      type: str
      description: User request to analyze
      required: true

  output_fields:
    - name: answer
      type: str
      description: Final response
      required: true

  tasks:
    - name: analyze_request
      instruction: Analyze the request and provide the best actionable answer.
      inputs:
        - name: query
          type: str
          description: User request
          required: true
      outputs:
        - name: answer
          type: str
          description: Final response

  crewai:
    rlm:
      enabled: true
      mode: assist
      backend: litellm
      environment: python
      max_iterations: 6
      max_depth: 1
      verbose: false
      persistent: false
      # Optional:
      # task_model: google-gla:gemini-2.5-flash
      # api_key_env: GOOGLE_API_KEY
      logger:
        enabled: false
        log_dir: .superoptix/logs/rlm
        file_name: crewai_rlm_demo

  feature_specifications:
    scenarios:
      - name: migration_plan
        description: Produce a concise migration plan.
        input:
          query: Create a low-risk migration strategy from monolith to microservices.
        expected_output:
          expected_keywords:
            - assumptions
            - risks
            - rollout

# Quick Start:
#   super agent pull crewai-rlm
#   super agent compile crewai-rlm --framework crewai --cloud --provider google-genai --model gemini-2.5-flash
#   super agent run crewai-rlm --cloud --provider google-genai --model gemini-2.5-flash --goal "Design a low-risk migration strategy"
